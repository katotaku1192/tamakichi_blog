---
showonlyimage: true
title:      "ステレオカメラ ZED2 接続テスト(Windows10)"
subtitle:   ""
#excerpt: ""
description: "ステレオカメラを使ってみるだけ"
date:       2020-08-14
author: Tamakichi
image: "/img/post-bg-zed2.jpg"
published: true 
tags:
    - ブログ
    - デバイス

#categories: [ Robocon ]
URL: "/2020/08/06/01/"
---

## はじめに
今回はSTEREOLABS社のステレオカメラ「**ZED2**」を使ってみました。  
製品サイトは[こちら。](https://www.stereolabs.com/zed-2/)
![](/img/20200814_zed2.jpg) 

研究で使うことになりそうなので、とりあえず動かしてみました。  
ただのステレオカメラだけでなく、**加速度**や**地磁気**、**気圧**や**温度**センサなどもついているうえに、**ROS**等にも対応しているらしく、すごく便利そうです。   
Amazonで買うと10万円くらいするみたいですね。ZEDの後継機のようです。   
細かい製品情報は先ほどのリンクをご覧ください。

## 環境
SDKの要求スペックは**少し高め**です。  
NvidiaのGPUが必要になるので気を付けてください。  
WindowsやUbuntuなどのOSに対応しています。  

>SDK System Requirements  
>  
>Dual-core 2.3GHz or faster processor  
>4 GB RAM or more  
>Nvidia GPU with compute capability \> 3.0  

実際に使った環境はこちら。  
  
| OS | Windows10 |
| --- | --- |
| CPU | Intel Core i7-9750H CPU @ 2.60GHz ×12 |
| GPU | Nvidia GeForce RTX 2070 |
| RAM | 32GB |

## SDKのインストール
ZED2を使うためには**SDK**が必要になります。  
[公式サイト](https://www.stereolabs.com/developers/release/)からダウンロードしましょう。  
SDK Downloadsのところにあります。  
自分は**CUDA 11.0**の**ZED SDK for Windows 10 3.2.2**にしました。  
お持ちのGPUやOSと相談して良さげなのを選んでください。
  
ダウンロードが完了したらインストールです。
**CUDA**が入っていない場合は途中でCUDAをインストールして良いか聞かれます。  
Yesで大丈夫ですが、私の場合はなぜか認識されず、あとでCUDAをインストールしなおすことになりました。（後述）

**インストール後は再起動が必要になりますが、インストーラの最後の選択ボタンが「すぐ再起動する」に選択された状態になっています。**
うっかり作業中のものを保存せずに再起動してしまうことのないように気をつけましょう。

### CUDAのインストール（必要な場合のみ）
インストールおわり！！さっそく使ってみよう！とZEDfu.exeを起動してみたところ、こんなメッセージが...

>cudart64_110.dll.がないため、プログラムを開始できません。この問題を解決するには、プログラムを再インストールしてみてください。

よくわからんが、CUDAに問題があるのか？？さっきインストールしてもらったはずなのに...

ということで試しに**Nvidia**のサイトから**CUDA11.0**をインストールしてみることにしました。  
[ここ](https://developer.nvidia.com/cuda-downloads)からプラットフォームを選んで、ダウンロード→指示通りにインストール。  
で、解決しました。何だったんだろう...

## 接続テスト
ようやく接続テストです。  

SDKを入れるとたくさんのソフトウェアがインストールされていますが、まずはシステム診断ソフト、**ZED_Diagnostic.exe**を起動してみます。  
カメラをつないでStartを押すと、自動でシステムを診断してくれます。  
"×"が出なければ大丈夫です。たぶん...  

"×"が出てしまう項目は、システム要件やカメラの接続、GPUがきちんと認識されているか、などもう一度確認してみてください。  

システムが大丈夫そうなら、**ZEDfu.exe**を起動してみましょう。
"Input"ボタンから"Live"を選択、"Start"を押すと、メッシュキャプチャが始まります。  
一度トラッキングが外れると、キャプチャがやり直しになってしまうので、ゆっくりと動かしてあげましょう。  

それで取れたデータがこちら。  
すごーい！
![](/img/20200814_mesh.png) 
視差のみで深度を取っているので、テクスチャのない平面などはおかしなことになっていますね。

最後に、入っているソフトの簡単な紹介をします。

**ZED_Diagnostic**  
　先ほど説明した通り、システム診断ツールです。  

**ZED_Explorer**  
　左右のカメラからのステレオ画像を取得できます。動画、静止画どちらでもOKです。  

**ZED_Depth_Viewer**  
　ステレオ画像の視差画像と深度が見られます。  

**ZEDfu**  
　先ほど説明した通り、メッシュデータを取得できます。メッシュデータは.plyファイルになります。  
　また、LIVEだけでなく、.svoファイル（動画）からもメッシュの取得が可能です。  

**ZED_Sensor_Viewer**  
　ZED2に搭載されている様々なセンサの値がわかります。  
　...が、自分の場合はセンサ値を得る前に落ちてしまいます...

今回はここまでにしようと思います。  

ZED2はPythonやROSなど様々な開発環境に対応しているので、今後はこのあたりを使って少し実践的なものを作ってみます！