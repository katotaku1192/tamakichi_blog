---
showonlyimage: true
title:      "ロボットにサイゼの間違い探しを解いてもらう"
subtitle:   ""
#excerpt: ""
description: "ロボットで未解決問題に挑む"
date:       2021-06-23
author: Tamakichi
image: "/img/20210623-machigaisagashi_Moment.jpg"
published: true 
tags:
    - ブログ
    - ものづくり

#categories: [ Robocon ]
URL: "/2021/06/23/01/"
---

## はじめに
世の中には、数多くの未解決問題があります。
なかでも、あのリーマン予想と並ぶ超難問として知られるのが、そう、
**サイゼリヤの間違い探しです。**

大手飲食チェーン「サイゼリヤ」のキッズメニューに掲載されている間違い探しは、どうみてもキッズな難易度ではなく、大人が本気でかかっても、10個すべての間違いを見つけるのはほぼ不可能とされています。

その難易度はSNSでも話題になり、「『間違いが10個ある』ということが間違いなのでは？」といった哲学的な問題にまで発展することもしばしば。


ちなみに本も出てます。今回のために買いました。600円くらい。
![](/img/20210623-book.JPG) 
>アツアツだよぉ～！　フーフーしてね～


この間違い探し。とても人がやるもんじゃない。

ならば**ロボットに任せてみたらどうか**？という発想から、今回のプロジェクトは始まりました。
ロボットを持って入店すれば、誰でも間違い探しが解ける。そんな素晴らしいロボットを目指します。  


## つくった
ということで、作りました。
{{< youtube LZVb0RBRmwM >}}

カメラでキッズメニューをキャプチャし、PCで解析した後、ロボットがペンで答えを書き込みます。
機構含め、すべて手作りです。

なかなかかわいくないですか？そうでもないですか？そうですか....


![](/img/20210623-answer.jpg) 
>ちなみにこちらのキッズメニューも正解は10個ありますが、8個しか解けていません。  
>つまり、ロボットをもってしても無理でした。まあ、未解決問題は未解決のままのほうが美しいっていいますよね。


## ロボットの構成
ここからは、ロボットの構成を簡単に紹介します。  
**詳細については、後日またアップできたらと思います**。

全体のシステム構成としてはこんな感じです。
![](/img/20210623-system.JPG)
### ハードウェア

ロボット本体のハードウェアは、3つのサーボモータを使った、3自由度のパラレルリンクロボットです。
産業用ロボットで良く採用される機構ですが、作るメーカーによってデルタロボットなど名称が違ったりします。  
私は幼少期からパラレルリンクロボットが大好きなので、この機構を採用しています。
他にも、常に手先の姿勢が一定に保たれるので、お絵かきにはもってこいですね。
![](/img/20210623-robot.JPG)

モータには、Dynamixel XL430-W250を使いました。U2D2を経由してPCにつないでいます。  
構造部分は、3Dプリンタで出力したABS樹脂と、アルミ角棒です。
エンドエフェクタには、ホワイトボードマーカーを使いました。厚紙で頑張って固定しています。

### ソフトウェア
だいたいの流れはこんな感じ。
全部Pythonで書きました。（C++にすればよかった…）

① 「正しい絵」と「間違った絵」の2枚の画像をカメラから読み込む。  
② OpenCVを使った画像処理で差分を求める。  
③ 差分から、間違いである（と思われる）点のみを抽出し、その座標を求める。    
④ 座標値から、ロボットの軌道を生成。  
⑤ そこから逆運動学で3つのモータの角度を求め、ロボットに渡す。  

流れとしては一本道で、人間が考えることと同じなので簡単だと思います。


一番苦労したのは、やはり間違い探しを解く（差分から間違いを抽出する）フェーズです。  
カメラで紙のメニューをキャプチャすることにより、多少の位置ずれが起きることがわかっていたため、特徴量マッチングからの射影変換を行い、2つの画像の位置や向きがほぼ同じになるように前処理を行っていました。  
しかし、それだけでは紙の歪み（曲がり）を消すことができず、歪み部分がそのまま差分（ロボットの考える「間違い」）として検出されてしまいました。
![](/img/20210623-before.jpg)
>赤色で囲ったところが、紙の歪みを差分として検出してしまった部分。  
>これでは本当の間違いとの区別がつかない。

そこで、さらに「正しい絵」の画像を8分割し、**それぞれのブロックに対して特徴量マッチングを行い**、その中で差分抽出をすることで、歪みの影響を減らすことにしました。ある意味、力技です。
![](/img/20210623-matching.PNG)

そうすると、ほら！  
歪みの影響がほとんどなくなり、間違いっぽいところだけを抽出できるようになりました。
![](/img/20210623-dif.PNG)
>すべてのパターンでそう上手くいくわけではなく、紙の歪み具合や絵柄によっても変わってくると思います。ロバスト性が今後の課題です。


## 余談
実は、ロボット本体に関しては、サイゼリヤの間違い探しを解くために作ったわけではなく、ただ「パラレルリンクロボットを作ってみたい」という欲望がもとになって製作が始まりました。  
しかし、何もしないロボットはロボットではありません（諸説あり）ので、「サイゼの間違い探しでもやらせてみたらおもろいんちゃう」というアイデアから、今回の結果に至りました。  
つまり、このロボットはサイゼの間違い探しだけではなく、他のこともやらせればできるはずです。
また何か面白いことができたらな～って日々考えています。

Twitterにあげたら、みんなすごいって言ってくれました。  
{{<tweet 1406225225453170695>}}

## 参考文献
[1] [パラレルリンクロボットを自作してみた（メカ編）](https://qiita.com/kizitorashiro/items/efb7715d06212aec6f98)  
[2] [パラレルリンクロボットを自作してみた（ソフト編）](パラレルリンクロボットを自作してみた（メカ編）)  
[3] [サイゼリヤ：キッズメニュー　間違い探し](https://www.saizeriya.co.jp/entertainment/)  
[4] [河本の実験室：サイゼリヤの間違い探しが難しすぎたので大人の力で解決した](https://kawalabo.blogspot.com/2014/11/blog-post.html)